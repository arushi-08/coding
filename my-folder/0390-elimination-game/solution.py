class Solution:
    def lastRemaining(self, n: int) -> int:
        # 4th last element?
        # n=2 
        # 1
        # n=3
        # 1,2,3 -> 2
        # n=4
        # 1,2,3,4 -> 2,4 -> 2
        # n=5
        # 1,2,3,4,5 -> 2,4 -> 2
        # n=6
        # 1,2,3,4,5,6 -> 2,4,6 -> 4
        # n=7
        # 1,2,3,4,5,6,7 -> 2,4,6 -> 4
        # n=8
        # 1,2,3,4,5,6,7,8 -> 2,4,6,8 -> 2,6 -> 6
        # n=9
        # 1,2,3,4,5,6,7,8,9 -> 2,4,6,8 -> 2,6 -> 6
        # n=10
        # 1,2,3,4,5,6,7,8,9,10 -> 2,4,6,8,10 -> 4,8 -> 8
        # n=11
        # 1,2,3,4,5,6,7,8,9,10,11 -> 2,4,6,8,10 -> 4,8 -> 8
        # n=12
        # 1,2,3,4,5,6,7,8,9,10,11,12 -> 2,4,6,8,10,12 -> 2,6,10 -> 6
        # n=14
        # 1,2,3,4,5,6,7,8,9,10,11,12,13,14 -> 2,4,6,8,10,12,14 -> 4,8,12 -> 8
        # n=15
        # 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15 -> 2,4,6,8,10,12,14 -> 4,8,12 -> 8
        # n=16
        # 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16 -> 2,4,6,8,10,12,14,16 -> 2,6,10,14 -> 6,14 -> 6
        # n=18
        # 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18 -> 2,4,6,8,10,12,14,16,18 -> 4,8,12,16 -> 8,16 -> 8
        # n=20
        # 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20 -> 2,4,6,8,10,12,14,16,18,20 -> 2,6,10,14,18 -> 6,14 -> 6
        # n=25
        # 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25 -> 2,4,6,8,10,12,14,16,18,20,22,24 -> 2,6,10,14,18,22 -> 6,14 -> 6

        # 10,100,110,1000,1010,1100,1110

        # if last % 4 == 2: 2 + 4, 2+4+4, 2+4+4+4
        # else :           4, 4+4, 4+4+4
        


        head = 1
        step = 1
        left = True
        remaining = n

        while remaining > 1:
            if left or remaining & 1 == 1:
                head += step
            step *= 2
            remaining //= 2
            left = not left

        return head

